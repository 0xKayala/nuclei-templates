id: CVE-2024-6387

info:
  name: OpenSSH regreSSHion Vulnerability (CVE-2024-6387)
  author: 0xKayala
  severity: high
  description: |
    This template checks for the Remote Unauthenticated Code Execution Vulnerability in OpenSSH servers.
    The vulnerability is associated with specific versions of OpenSSH.
    The template targets multiple IP addresses, URLs, CIDR ranges, and ports.

tcp:
  - inputs:
      - data: "\r\n"
    host:
      - "{{Hostname}}"
    port: 22
    read-size: 1024

    matchers-condition: and
    matchers:
      - type: regex
        name: vulnerable-versions
        regex:
          - "SSH-2.0-OpenSSH_(1|2|3|4\\.[0-4]|8\\.[5-9]|9\\.[0-7])\\b"
        part: data
      - type: regex
        name: patched-versions
        negative: true
        regex:
          - "SSH-2.0-OpenSSH_8\\.9p1 Ubuntu-3ubuntu0\\.10"
          - "SSH-2.0-OpenSSH_9\\.3p1 Ubuntu-3ubuntu3\\.6"
          - "SSH-2.0-OpenSSH_9\\.6p1 Ubuntu-3ubuntu13\\.3"
          - "SSH-2.0-OpenSSH_9\\.3p1 Ubuntu-1ubuntu3\\.6"
          - "SSH-2.0-OpenSSH_9\\.2p1 Debian-2\\+deb12u3"
          - "SSH-2.0-OpenSSH_8\\.4p1 Debian-5\\+deb11u3"
          - "SSH-2.0-OpenSSH_9\\.7p1 Debian-7"
        part: data
